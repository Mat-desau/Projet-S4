#include "xil_printf.h"
#include "xparameters.h"
#include "sleep.h"
#include <xiic.h>
#include "initCodec.h"
#include "gestionAudio.h"
#include "uart.h"
#include "fft.h"
#include "FIFO_FFT_driver.h"



//Dependencies
#include <stdlib.h>
#include <stdio.h>
#include "xil_io.h"
#include "cyclone_tcp/core/net.h"
#include "cyclone_tcp/net_config.h"
#include "cyclone_tcp/drivers/eth/enc624j600_driver.h"
#include "cyclone_tcp/core/udp.h"
#include "xspi.h"
#include "cyclone_tcp/spi_driver.h"
#include "cyclone_tcp/ext_int_driver.h"
#include <stdbool.h>
#include "comm.h"


#define IIC_BASE_ADDRESS	XPAR_IIC_0_BASEADDR



void init(){
	xil_printf("Init OK\n\r");
	initAudio();
	sleep(1);
	initCodec();
	sleep(1);
	initComm();
	//uartInit();
	initFIFO_FFT();
	sleep(1);
	configProjetS4();




}



int main(){
	sleep(1);
	init();

	while(1){
		//uartTask();

		if(flagDonnesOiseau){
			//xil_printf("d\n\r");
			//u32 *premierInt = (u32 *)(BufferMain);
			//XUartLite_Send(&UartLite, BufferMain , MAX_FFT_LEN*4);

			if(flagDonnesOiseau & 0x01){
				xil_printf("Bruyant \n\r");
				transmettreOiseau(1);


			}

			if(flagDonnesOiseau & 0x02){
				xil_printf("Huard \n\r");
			}

			if(flagDonnesOiseau & 0x04){
				xil_printf("Coq \n\r");
			}


			flagDonnesOiseau = 0;

		}




	}


}
